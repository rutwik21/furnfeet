(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[565],{6264:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});var r=t(2898);let i=(0,r.Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2549:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});var r=t(2898);let i=(0,r.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9166:function(e,s,t){Promise.resolve().then(t.bind(t,2215))},2215:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return page}});var r=t(7437),i=t(345),a=t(3089),n=t(2265),d=t(6582),l=t(1865),c=t(4578);let o=c.z.object({name:c.z.string(),contact:c.z.number().or(c.z.string()),addressLine1:c.z.string(),addressLine2:c.z.string().nullable(),city:c.z.string(),state:c.z.string(),pinCode:c.z.string()});c.z.object({id:c.z.string(),name:c.z.string(),contact:c.z.number().or(c.z.string()),addressLine1:c.z.string(),addressLine2:c.z.string().nullable(),city:c.z.string(),state:c.z.string(),pinCode:c.z.string(),isDefaultAddress:c.z.boolean()});var m=t(8110),u=t(2783),x=t(1424),p=t(6264),h=t(2442),components_ConfirmAddress=e=>{let{handleAddressConfirmation:s}=e,[t,g]=(0,n.useState)([]),{register:f,handleSubmit:j,formState:{errors:y}}=(0,l.cI)({resolver:(0,m.F)(o)}),[b,v]=(0,n.useState)(!1),{mutate:N,isLoading:w}=u.S.user.addNewAddress.useMutation({onError:e=>{var s;if((null===(s=e.data)||void 0===s?void 0:s.code)==="BAD_REQUEST"){x.toast.error("Please provide all the valid details");return}if(e instanceof c.jm){x.toast.error(e.issues[0].message);return}x.toast.error("Something went wrong. Please try again.")},onSuccess:e=>{e&&g(e),window.document.querySelector("#newAddressForm").reset(),v(!1)}}),z=u.S.user.updateAddress.useMutation({onError:e=>{var s;if((null===(s=e.data)||void 0===s?void 0:s.code)==="BAD_REQUEST"){x.toast.error("Please provide all the valid details");return}if(e instanceof c.jm){x.toast.error(e.issues[0].message);return}x.toast.error("Something went wrong. Please try again.")},onSuccess:e=>{e&&g(e)}});u.S.user.allAddresses.useQuery(void 0,{onError:e=>{console.log(e)},onSuccess:e=>{e&&g(e)}});let onUpadteAddressSubmit=e=>{let{id:s,name:t,contact:r,addressLine1:i,addressLine2:a,city:n,state:d,pinCode:l,isDefaultAddress:c}=e;r=Number(r),z.mutate({id:s,name:t,contact:r,addressLine1:i,addressLine2:a,city:n,state:d,pinCode:l,isDefaultAddress:c})};return(0,r.jsx)("div",{className:"rounded-lg border-2 border-dashed border-zinc-200 p-4 md:p-12 lg:col-span-7",children:(0,r.jsxs)("div",{className:"",children:[(0,r.jsxs)("div",{className:"flex col-span-full justify-between border-b pb-4 mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold my-1 text-gray-900",children:"Your Addresses"}),(0,r.jsx)(a.z,{className:" py-2 px-4",onClick:()=>v(!b),children:b?"Cancel":"Add New Address"})]}),b&&(0,r.jsxs)("div",{className:"rounded-lg p-6 mb-6 bg-gray-50 ",children:[(0,r.jsx)("h2",{className:"text-lg font-medium my-2 text-gray-900",children:"Add New Address"}),(0,r.jsxs)("form",{id:"newAddressForm",onSubmit:j(e=>{let{name:s,contact:t,addressLine1:r,addressLine2:i,city:a,state:n,pinCode:d}=e;N({name:s,contact:t=Number(t),addressLine1:r,addressLine2:i,city:a,state:n,pinCode:d})}),children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(d.I,{type:"text",placeholder:"Name*",...f("name"),className:(0,i.cn)({"focus-visible:ring-red-500":y.name})}),(null==y?void 0:y.name)&&(0,r.jsx)("p",{className:"text-sm text-red-500",children:y.name.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.I,{type:"number",placeholder:"Mobile no.*",...f("contact"),className:(0,i.cn)({"focus-visible:ring-red-500":y.contact})}),(null==y?void 0:y.contact)&&(0,r.jsx)("p",{className:"text-sm text-red-500",children:y.contact.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.I,{type:"text",placeholder:"Address Line 1*",...f("addressLine1"),className:(0,i.cn)({"focus-visible:ring-red-500":y.addressLine1}),required:!0}),(null==y?void 0:y.addressLine1)&&(0,r.jsx)("p",{className:"text-sm text-red-500",children:y.addressLine1.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.I,{type:"text",placeholder:"Address Line 2",...f("addressLine2"),className:(0,i.cn)({"focus-visible:ring-red-500":y.addressLine2})}),(null==y?void 0:y.addressLine2)&&(0,r.jsx)("p",{className:"text-sm text-red-500",children:y.addressLine2.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.I,{type:"text",placeholder:"City*",...f("city"),className:(0,i.cn)({"focus-visible:ring-red-500":y.city}),required:!0}),(null==y?void 0:y.city)&&(0,r.jsx)("p",{className:"text-sm text-red-500",children:y.city.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.I,{type:"text",placeholder:"State*",...f("state"),className:(0,i.cn)({"focus-visible:ring-red-500":y.state}),required:!0}),(null==y?void 0:y.state)&&(0,r.jsx)("p",{className:"text-sm text-red-500",children:y.state.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.I,{type:"text",placeholder:"Pin Code*",...f("pinCode"),className:(0,i.cn)({"focus-visible:ring-red-500":y.pinCode}),required:!0}),(null==y?void 0:y.pinCode)&&(0,r.jsx)("p",{className:"text-sm text-red-500",children:y.pinCode.message})]})]}),(0,r.jsxs)(a.z,{type:"submit",className:"mt-4 py-2 px-4",children:[w?(0,r.jsx)(p.Z,{className:"w-4 h-4 animate-spin mr-1.5"}):null,"Add Address"]})]})]}),(0,r.jsx)("div",{className:"space-y-4",children:t.map(e=>(e.isDefaultAddress&&s(!0),(0,r.jsxs)("div",{className:(0,i.cn)("border rounded-lg p-6",{"bg-green-50 border-primary":e.isDefaultAddress,"bg-white border-gray-500":!e.isDefaultAddress}),children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("h2",{className:"text-xl w-auto font-semibold text-gray-900",children:e.name}),e.isDefaultAddress?(0,r.jsxs)(a.z,{size:"sm",variant:"ghost",className:"bg-green-100 text-black",children:["Selected ",(0,r.jsx)("span",{children:(0,r.jsx)(h.Z,{className:"w-4 ms-1"})})]}):(0,r.jsx)(a.z,{onClick:()=>(e.addressLine2=void 0!=e.addressLine2?e.addressLine2:null,onUpadteAddressSubmit({id:e.id,name:e.name,contact:e.contact,addressLine1:e.addressLine1,addressLine2:e.addressLine2,city:e.city,state:e.state,pinCode:e.pinCode,isDefaultAddress:!0})),size:"sm",className:"bg-secondary text-black",children:"Select"})]}),(0,r.jsxs)("p",{children:[e.addressLine1,", ",e.addressLine2]}),(0,r.jsxs)("p",{children:[e.city,", ",e.state," - ",e.pinCode]}),(0,r.jsxs)("p",{className:"text-sm w-auto font-semibold text-gray-900",children:["Mobile No. : ",e.contact]})]},e.id)))})]})})},g=t(9233),f=t(4303),j=t(2549),y=t(6691),b=t.n(y),v=t(1396),N=t.n(v),w=t(4033),page=()=>{let{items:e,removeItem:s,reduceItem:t,addItem:d,clearCart:l}=(0,f.j)(),[c,o]=(0,n.useState)(!1),[m,y]=(0,n.useState)(!1),v=(0,w.useRouter)(),{mutate:z}=u.S.payment.markOrderAsPaid.useMutation({onError:e=>{console.log(e),x.toast.error("Something went wrong! Please reach out to us if you faced some issue while payment")},onSuccess:e=>{e?(l(),v.push("".concat("http://localhost:3000","/thank-you?orderId=").concat(e))):x.toast.error("Something went wrong! Please reach out to us if you faced some issue while payment")}}),{mutate:S,isLoading:k}=u.S.payment.createSession.useMutation({onSuccess:e=>{let{orderId:s,key_id:t}=e;if(s&&t){let e=new window.Razorpay({key:t,order_id:s,name:"furnfeet",description:"Test Transaction",handler:function(e){e.orderId=s,z(e)},image:"https://furnfeettest.s3.eu-north-1.amazonaws.com/ff_logo.png",theme:{color:"#f97316"}});e.open(),e.on("payment.failed",function(e){x.toast.error(e.error.reason)})}else alert("something went wrong")}}),C=e.map(e=>{let{product:s,qty:t,dimensions:r,price:i,totalPrice:a}=e;return{productId:s.id,qty:t,dimensions:r,price:i,totalPrice:a}}),[A,L]=(0,n.useState)(!1);(0,n.useEffect)(()=>{L(!0)},[]);let q=e.reduce((e,s)=>{let{price:t,qty:r}=s,i="string"!=typeof t?t:null;return i?e+i*r:0},0);return(0,r.jsxs)("div",{className:"bg-white",children:[(0,r.jsx)("script",{src:"https://checkout.razorpay.com/v1/checkout.js",defer:!0}),(0,r.jsxs)("div",{className:"mx-auto max-w-2xl px-4 pb-24 pt-16 sm:px-6 lg:max-w-7xl lg:px-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl",children:"Shopping Cart"}),(0,r.jsxs)("div",{className:"mt-12 lg:grid lg:grid-cols-12 lg:items-start lg:gap-x-12 xl:gap-x-16",children:[(0,r.jsxs)("div",{className:(0,i.cn)("lg:col-span-7",{"rounded-lg border-2 border-dashed border-zinc-200 p-12":A&&0===e.length},{hidden:c}),children:[(0,r.jsx)("h2",{className:"sr-only",children:"Items in your shopping cart"}),A&&0===e.length?(0,r.jsxs)("div",{className:"flex h-full flex-col items-center justify-center space-y-1",children:[(0,r.jsx)("div",{"aria-hidden":"true",className:"relative mb-4 h-40 w-40 text-muted-foreground",children:(0,r.jsx)(b(),{src:"/emptyCart.png",fill:!0,loading:"eager",alt:"empty shopping cart hippo"})}),(0,r.jsx)("h3",{className:"font-semibold text-2xl",children:"Your cart is empty"}),(0,r.jsx)("p",{className:"text-muted-foreground text-center",children:"Whoops! Nothing to show here yet."})]}):null,(0,r.jsx)("ul",{className:(0,i.cn)({"divide-y divide-gray-200 border-b border-t border-gray-200":A&&e.length>0}),children:A&&e.map(e=>{var n;let l=null===(n=g.Z.find(s=>s.value===e.product.category))||void 0===n?void 0:n.label,{image:c}=e.product.images[0];return(0,r.jsxs)("li",{className:"flex py-6 sm:py-10",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"relative h-24 w-24",children:"string"!=typeof c&&c.url?(0,r.jsx)(b(),{fill:!0,src:c.url,alt:"product image",className:"h-full w-full rounded-md object-cover object-center sm:h-48 sm:w-48"}):null})}),(0,r.jsxs)("div",{className:"ml-4 flex flex-1 flex-col justify-between sm:ml-6",children:[(0,r.jsxs)("div",{className:"relative pr-9 sm:grid sm:grid-cols-2 sm:gap-x-6 sm:pr-0",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex justify-between",children:(0,r.jsx)("h3",{className:"text-sm",children:(0,r.jsx)(N(),{href:"/product/".concat(e.product.id),className:"font-medium text-gray-700 hover:text-gray-800",children:e.product.name})})}),(0,r.jsx)("div",{className:"mt-1 flex text-sm",children:(0,r.jsxs)("p",{className:"text-muted-foreground",children:["Category: ",l]})}),(0,r.jsxs)("div",{className:"mt-1 gap-2 flex text-sm",children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"Qty:"}),(0,r.jsxs)("div",{className:"flex gap-2 px-2 bg-gray-50 rounded-sm  text-sm",children:[(0,r.jsx)("button",{onClick:()=>t(e.product),className:"flex self-center",children:"-"}),(0,r.jsx)("p",{children:e.qty}),(0,r.jsx)("button",{onClick:()=>d(e),className:"flex self-center",children:"+"})]})]}),(0,r.jsx)("p",{className:"mt-1 text-sm font-medium text-gray-900",children:"string"!=typeof e.price?(0,i.T)(e.price*e.qty):null})]}),(0,r.jsx)("div",{className:"mt-4 sm:mt-0 sm:pr-9 w-20",children:(0,r.jsx)("div",{className:"absolute right-0 top-0",children:(0,r.jsx)(a.z,{"aria-label":"remove product",onClick:()=>s(e.product.id),variant:"ghost",children:(0,r.jsx)(j.Z,{className:"h-5 w-5","aria-hidden":"true"})})})})]}),(0,r.jsxs)("p",{className:"mt-4 flex space-x-2 text-sm text-gray-700",children:[(0,r.jsx)(h.Z,{className:"h-5 w-5 flex-shrink-0 text-green-500"}),(0,r.jsx)("span",{children:"Eligible for instant delivery"})]})]})]},e.product.id)})})]}),(0,r.jsx)("div",{className:(0,i.cn)("lg:col-span-7",{"rounded-lg border-2 border-dashed border-zinc-200 p-12":A&&0===e.length},{hidden:!c}),children:(0,r.jsx)(components_ConfirmAddress,{handleAddressConfirmation:e=>{y(e)}})}),(0,r.jsxs)("section",{className:"mt-16 rounded-lg bg-gray-50 px-4 py-6 sm:p-6 lg:col-span-5 lg:mt-0 lg:p-8",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Order summary"}),(0,r.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Subtotal"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:A?(0,i.T)(q):(0,r.jsx)(p.Z,{className:"h-4 w-4 animate-spin text-muted-foreground"})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4",children:[(0,r.jsx)("div",{className:"flex items-center text-sm text-muted-foreground",children:(0,r.jsx)("span",{children:"Flat Transaction Fee"})}),(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:A?(0,i.T)(10):(0,r.jsx)(p.Z,{className:"h-4 w-4 animate-spin text-muted-foreground"})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4",children:[(0,r.jsx)("div",{className:"text-base font-medium text-gray-900",children:"Order Total"}),(0,r.jsx)("div",{className:"text-base font-medium text-gray-900",children:A?(0,i.T)(q+10):(0,r.jsx)(p.Z,{className:"h-4 w-4 animate-spin text-muted-foreground"})})]})]}),(0,r.jsx)("div",{className:"mt-6",children:c?(0,r.jsxs)(a.z,{disabled:0===e.length||c&&!m||0===q,onClick:()=>S(C),className:"w-full",size:"lg",children:[k?(0,r.jsx)(p.Z,{className:"w-4 h-4 animate-spin mr-1.5"}):null,"Make Payment"]}):(0,r.jsxs)(a.z,{disabled:0===e.length||0===q,onClick:()=>o(!0),className:"w-full",size:"lg",children:[k?(0,r.jsx)(p.Z,{className:"w-4 h-4 animate-spin mr-1.5"}):null,"Checkout"]})})]})]})]})]})}},3089:function(e,s,t){"use strict";t.d(s,{d:function(){return l},z:function(){return c}});var r=t(7437),i=t(2265),a=t(7256),n=t(6061),d=t(345);let l=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=i.forwardRef((e,s)=>{let{className:t,variant:i,size:n,asChild:c=!1,...o}=e,m=c?a.g7:"button";return(0,r.jsx)(m,{className:(0,d.cn)(l({variant:i,size:n,className:t})),ref:s,...o})});c.displayName="Button"},6582:function(e,s,t){"use strict";t.d(s,{I:function(){return n}});var r=t(7437),i=t(2265),a=t(345);let n=i.forwardRef((e,s)=>{let{className:t,type:i,...n}=e;return(0,r.jsx)("input",{type:i,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});n.displayName="Input"},4303:function(e,s,t){"use strict";t.d(s,{j:function(){return a}});var r=t(4660),i=t(4810);let a=(0,r.Ue)()((0,i.tJ)(e=>({items:[],addItem:s=>e(e=>{let t=!1;return(e.items=e.items.map(e=>(e.product.id===s.product.id&&(e.qty=e.qty+1,e.totalPrice=e.price*e.qty,t=!0),e)),t)?{items:e.items}:{items:[...e.items,{product:s.product,qty:s.qty||1,isCustomized:s.isCustomized,dimensions:s.dimensions,price:s.price,totalPrice:s.price*s.qty||1}]}}),reduceItem:s=>e(e=>{let t=!1;return(e.items=e.items.map(e=>(e.product.id===s.id&&(e.qty=e.qty-1,e.totalPrice=e.price*e.qty,e.qty<=0&&(t=!0)),e)),t)?{items:e.items.filter(e=>e.product.id!==s.id)}:{items:e.items}}),removeItem:s=>e(e=>({items:e.items.filter(e=>e.product.id!==s)})),clearCart:()=>e({items:[]})}),{name:"cart-storage",storage:(0,i.FL)(()=>localStorage)}))}},function(e){e.O(0,[256,985,0,583,424,368,487,971,472,744],function(){return e(e.s=9166)}),_N_E=e.O()}]);